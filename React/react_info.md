# 理解React
### Diff策略
> React 最为核心的就是 Virtual DOM 和 Diff 算法。React 在内存中维护一颗虚拟 DOM 树，当数据发生改变时（state & props），会自动的更新虚拟 DOM，获得一个新的虚拟 DOM 树，然后通过 Diff 算法，比较新旧虚拟 DOM 树，找出最小的有变化的部分，将这个变化的部分（Patch）加入队列，最终批量的更新这些 Patch 到实际的 DOM 中。

- 两个假设
	1. 两个不同类型的元素会产生出不同的树
	2. 开发者可以通过key来指定子元素在不同的渲染下能保持稳定
- 三个策略
	1. Web UI 中 DOM 节点跨层级的移动操作特别少，可以忽略不计
	2. 拥有相同类型的两个组件将会生成相似的树形结构，拥有不同类型的两个组件将会生成不同树形结构
	3. 对于同一层级的一组子节点，它们可以通过唯一 key 进行区分
- 具体优化
	- tree diff
		- 通过updateDepth对虚拟Dom树进行层级控制，只会对相同颜色框内的节点进行比较，根据对比结果，进行节点的新增和删除。如此只需要遍历一次虚拟Dom树，就可以完成整个的对比
		- 如果发生跨级操作，React是不复用已有节点
	- component diff
		- 如果是同类型组件，首先使用 shouldComponentUpdate()方法判断是否需要进行比较，如果返回true，继续按照 React diff 策略比较组件的虚拟 DOM 树，否则不需要比较
		- 如果是不同类型的组件，则将该组件判断为 dirty component，从而替换整个组件下的所有子节点
	- element diff
		- 对新集合进行遍历，通过唯一 key 来判断老集合中是否存在相同的节点
		- 如果没有，则创建
		- 如果有，则判断是否需要进行移动操作

### 调度原理

### 性能优化